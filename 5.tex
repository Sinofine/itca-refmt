In classical algebraic geometry curves were frequently studied by projecting them onto a line and regarding the curve as a (ramified) covering of the line. This is quite analogous to the relationship between a number field and the rational field---or rather between their rings of integers---and the common algebraic feature is the notion of integral dependence. In this chapter we prove a number of results about integral dependence. In particular we prove the theorems of Cohen-Seidenberg (the ``going-up'' and ``going-down'' theorems) concerning prime ideals in an integral extension. In the exercises at the end we discuss the algebro-geometric situation and in particular the Normalization Lemma.

We also give a brief treatment of valuations.

\section{Integral Dependence}
Let $B$ be a ring, $A$ a subring of $B$ (so that $1 \in A$). An element $x$ of $B$ is said to be \textit{integral over} $A$ if $x$ is a root of a monic polynomial with coefficients in $A$, that is if $x$ satisfies an equation of the form

\[
x^{n}+a_{1} x^{n-1}+\cdots+a_{n}=0
\]

where the $a_{i}$ are elements of $A$. Clearly every element of $A$ is integral over $A$.

\begin{example}
$A=\mathbf{Z}, B=\mathbf{Q}$. If a rational number $x=r / s$ is integral over $\mathbf{Z}$, where $r, s$ have no common factor, we have from (1)

\[
r^{n}+a_{1} r^{n-1} s+\cdots+a_{n} s^{n}=0
\]

the $a_{i}$ being rational integers. Hence $s$ divides $r^{n}$, hence $s= \pm 1$, hence $x \in \mathbf{Z}$.
\end{example}

\begin{proposition}\label{prop:5.1}
The following are equivalent:
\begin{enumerate}[i)]
\item $x \in B$ is integral over $A$;
\item $A[x]$ is a finitely generated $A$-module;
\item $A[x]$ is contained in a subring $C$ of $B$ such that $C$ is a finitely generated $A$-module;
\item There exists a faithful $A[x]$-module $M$ which is finitely generated as an $A$-module.
\end{enumerate}
\end{proposition}

\begin{proof}
\begin{enumerate}[i)]
\item $\Rightarrow$ ii). From (1) we have

\[
x^{n+r}=-\left(a_{1} x^{n+r-1}+\cdots+a_{n} x^{r}\right)
\]

for all $r \geqslant 0$; hence, by induction, all positive powers of $x$ lie in the $A$-module generated by $1, x, \ldots, x^{n-1}$. Hence $A[x]$ is generated (as an $A$-module) by $1, x, \ldots, x^{n-1}$.

\item $\Rightarrow$ iii). Take $C=A[x]$.

\item $\Rightarrow$ iv). Take $M=C$, which is a faithful $A[x]$-module (since $y C=0 \Rightarrow$ $y \cdot 1=0$ ).

\item $\Rightarrow$ i). This follows from \eqref{prop:2.4}: take $\phi$ to be multiplication by $x$, and $\mathfrak{a}=A$ (we have $x M \subseteq M$ since $M$ is an $A[x]$-module); since $M$ is faithful, we have $x^{n}+a_{1} x^{n-1}+\cdots+a_{n}=0$ for suitable $a_{i} \in A$.
\end{enumerate}
\end{proof}

\begin{corollary}\label{cor:5.2}
Let $x_{i}(1 \leqslant i \leqslant n)$ be elements of $B$, each integral over $A$. Then the ring $A\left[x_{1}, \ldots, x_{n}\right]$ is a finitely-generated $A$-module.
\end{corollary}

\begin{proof}
By induction on $n$. The case $n=1$ is part of \eqref{prop:5.1}. Assume $n>1$, let $A_{r}=A\left[x_{1}, \ldots, x_{r}\right]$; then by the inductive hypothesis $A_{n-1}$ is a finitely generated $A$-module. $A_{n}=A_{n-1}\left[x_{n}\right]$ is a finitely generated $A_{n-1}$-module (by the case $n=1$, since $x_{n}$ is integral over $A_{n-1}$). Hence by \eqref{prop:2.16} $A_{n}$ is finitely generated as an $A$-module.
\end{proof}

\begin{corollary}\label{cor:5.3}
The set $C$ of elements of $B$ which are integral over $A$ is a subring of $B$ containing $A$.
\end{corollary}

\begin{proof}
If $x, y \in C$ then $A[x, y]$ is a finitely generated $A$-module by \eqref{cor:5.2}. Hence $x \pm y$ and $x y$ are integral over $A$, by iii) of \eqref{prop:5.1}.
\end{proof}

The ring $C$ in \eqref{cor:5.3} is called the \textit{integral closure} of $A$ in $B$. If $C=A$, then $A$ is said to be \textit{integrally closed} in $B$. If $C=B$, the ring $B$ is said to be \textit{integral} over $A$.

\begin{remark}
Let $f: A \rightarrow B$ be a ring homomorphism, so that $B$ is an $A$-algebra. Then $f$ is said to be \textit{integral}, and $B$ is said to be an \textit{integral} $A$-\textit{algebra}, if $B$ is integral over its subring $f(A)$. In this terminology, the above results show that

\[
\text { finite type }+ \text { integral }=\text { finite. }
\]
\end{remark}

\begin{corollary}\label{cor:5.4}
If $A \subseteq B \subseteq C$ are rings and if $B$ is integral over $A$, and $C$ is integral over $B$, then $C$ is integral over $A$ (transitivity of integral dependence).
\end{corollary}

\begin{proof}
Let $x \in C$, then we have an equation

\[
x^{n}+b_{1} x^{n-1}+\cdots+b_{n}=0 \quad\left(b_{i} \in B\right) .
\]

The ring $B^{\prime}=A\left[b_{1}, \ldots, b_{n}\right]$ is a finitely generated $A$-module by \eqref{cor:5.2}, and $B^{\prime}[x]$ is a finitely generated $B^{\prime}$-module (since $x$ is integral over $B^{\prime}$). Hence $B^{\prime}[x]$ is a finitely generated $A$-module by \eqref{prop:2.16} and therefore $x$ is integral over $A$ by iii) of \eqref{prop:5.1}.
\end{proof}

\begin{corollary}\label{cor:5.5}
Let $A \subseteq B$ be rings and let $C$ be the integral closure of $A$ in $B$. Then $C$ is integrally closed in $B$.
\end{corollary}

\begin{proof}
Let $x \in B$ be integral over $C$. By \eqref{cor:5.4} $x$ is integral over $A$, hence $x \in C$.
\end{proof}

The next proposition shows that integral dependence is preserved on passing to quotients and to rings of fractions:

\begin{proposition}\label{prop:5.6}
Let $A \subseteq B$ be rings, $B$ integral over $A$.
\begin{enumerate}[i)]
\item If $\mathfrak{b}$ is an ideal of $B$ and $\mathfrak{a}=\mathfrak{b}^{\mathfrak{c}}=A \cap \mathfrak{b}$, then $B / \mathfrak{b}$ is integral over $A / \mathfrak{a}$.
\item If $S$ is a multiplicatively closed subset of $A$, then $S^{-1} B$ is integral over $S^{-1} A$.
\end{enumerate}
\end{proposition}

\begin{proof}
\begin{enumerate}[i)]
\item If $x \in B$ we have, say, $x^{n}+a_{1} x^{n-1}+\cdots+a_{n}=0$, with $a_{1} \in A$. Reduce this equation mod. $\mathfrak{b}$.

\item Let $x / s \in S^{-1} B(x \in B, s \in S)$. Then the equation above gives

\[
(x / s)^{n}+\left(a_{1} / s\right)(x / s)^{n-1}+\cdots+a_{n} / s^{n}=0
\]

which shows that $x / s$ is integral over $S^{-1} A$.
\end{enumerate}
\end{proof}

\section{The Going-up Theorem}

\begin{proposition}\label{prop:5.7}
Let $A \subseteq B$ be integral domains, $B$ integral over $A$. Then $B$ is a field if and only if $A$ is a field.
\end{proposition}

\begin{proof}
Suppose $A$ is a field; let $y \in B, y \neq 0$. Let

\[
y^{n}+a_{1} y^{n-1}+\cdots+a_{n}=0 \quad\left(a_{i} \in A\right)
\]

be an equation of integral dependence for $y$ of smallest possible degree. Since $B$ is an integral domain we have $a_{n} \neq 0$, hence $y^{-1}=-a_{n}^{-1}\left(y^{n-1}+a_{1} y^{n-2}+\cdots+a_{n-1}\right) \in B$. Hence $B$ is a field.

Conversely, suppose $B$ is a field; let $x \in A, x \neq 0$. Then $x^{-1} \in B$, hence is integral over $A$, so that we have an equation

\[
x^{-m}+a_{1}^{\prime} x^{-m+1}+\cdots+a_{m}^{\prime}=0 \quad\left(a_{i}^{\prime} \in A\right) .
\]

It follows that $x^{-1}=-\left(a_{1}^{\prime}+a_{2}^{\prime} x+\cdots+a_{m}^{\prime} x^{m-1}\right) \in A$, hence $A$ is a field.
\end{proof}

\begin{corollary}\label{cor:5.8}
Let $A \subseteq B$ be rings, $B$ integral over $A$; let $\mathfrak{q}$ be a prime ideal of $B$ and let $\mathfrak{p}=\mathfrak{q}^{c}=\mathfrak{q} \cap A$. Then $\mathfrak{q}$ is maximal if and only if $\mathfrak{p}$ is maximal.
\end{corollary}

\begin{proof}
By \eqref{prop:5.6}, $B / \mathfrak{q}$ is integral over $A / \mathfrak{p}$, and both these rings are integral domains. Now use \eqref{prop:5.7}.
\end{proof}

\begin{corollary}\label{cor:5.9}
Let $A \subseteq B$ be rings, $B$ integral over $A$; let $q, q^{\prime}$ be prime ideals of $B$ such that $\mathfrak{q} \subseteq \mathfrak{q}^{\prime}$ and $\mathfrak{q}^{c}=\mathfrak{q}^{\prime c}=\mathfrak{p}$ say. Then $\mathfrak{q}=\mathfrak{q}^{\prime}$.
\end{corollary}

\begin{proof}
By \eqref{prop:5.6}, $B_{\mathfrak{p}}$ is integral over $A_{\mathfrak{p}}$. Let $\mathfrak{m}$ be the extension of $\mathfrak{p}$ in $A_{\mathfrak{p}}$ and let $\mathfrak{n}, \mathfrak{n}^{\prime}$ be the extensions of $\mathfrak{q}, q^{\prime}$ respectively in $B_{\mathfrak{p}}$. Then $\mathfrak{m}$ is the maximal ideal of $A_{\mathfrak{p}}$; $\mathfrak{n} \subseteq \mathfrak{n}^{\prime}$, and $\mathfrak{n}^{c}=\mathfrak{n}^{\prime c}=\mathfrak{m}$. By \eqref{cor:5.8} it follows that $\mathfrak{n}, \mathfrak{n}^{\prime}$ are maximal, hence $\mathfrak{n}=\mathfrak{n}^{\prime}$, hence by \eqref{prop:3.11}(iv) $q=q^{\prime}$.
\end{proof}

\begin{theorem}\label{thm:5.10}
Let $A \subseteq B$ be rings, $B$ integral over $A$, and let $\mathfrak{p}$ be a prime ideal of $A$. Then there exists a prime ideal $\mathfrak{q}$ of $B$ such that $\mathfrak{q} \cap A=\mathfrak{p}$.
\end{theorem}

\begin{proof}
By \eqref{prop:5.6}, $B_{\mathfrak{p}}$ is integral over $A_{\mathfrak{p}}$, and the diagram

\[
\begin{aligned}
A & \rightarrow B \\
\alpha \downarrow & \downarrow \beta \\
A_{\mathfrak{p}} & \rightarrow B_{\mathfrak{p}}
\end{aligned}
\]

(in which the horizontal arrows are injections) is commutative. Let $\mathfrak{n}$ be a maximal ideal of $B_{\mathfrak{p}}$; then $\mathfrak{m}=\mathfrak{n} \cap A_{\mathfrak{p}}$ is maximal by \eqref{cor:5.8}, hence is the unique maximal ideal of the local ring $A_{\mathfrak{p}}$. If $\mathfrak{q}=\beta^{-1}(\mathfrak{n})$, then $\mathfrak{q}$ is prime and we have $\mathfrak{q} \cap A=\alpha^{-1}(\mathfrak{m})=\mathfrak{p}$.
\end{proof}

\begin{theorem}[Going-up theorem]\label{thm:5.11}
Let $A \subseteq B$ be rings, $B$ integral over $A$; let $\mathfrak{p}_{1} \subseteq \cdots \subseteq \mathfrak{p}_{n}$ be a chain of prime ideals of $A$ and $\mathfrak{q}_{1} \subseteq \cdots \subseteq \mathfrak{q}_{m}$ $(m<n)$ a chain of prime ideals of $B$ such that $\mathfrak{q}_{i} \cap A=\mathfrak{p}_{i}(1 \leqslant i \leqslant m)$. Then the chain $\mathfrak{q}_{1} \subseteq \cdots \subseteq \mathfrak{q}_{m}$ can be extended to a chain $\mathfrak{q}_{1} \subseteq \cdots \subseteq \mathfrak{q}_{n}$ such that $\mathfrak{q}_{i} \cap A=\mathfrak{p}_{i}$ for $1 \leqslant i \leqslant n$.
\end{theorem}

\begin{proof}
By induction we reduce immediately to the case $m=1, n=2$. Let $\bar{A}=A / \mathfrak{p}_{1}, \bar{B}=B / \mathfrak{q}_{1}$; then $\bar{A} \subseteq \bar{B}$, and $\bar{B}$ is integral over $\bar{A}$ by \eqref{prop:5.6}. Hence, by \eqref{thm:5.10}, there exists a prime ideal $\bar{\mathfrak{q}}_{2}$ of $\bar{B}$ such that $\bar{\mathfrak{q}}_{2} \cap \bar{A}=\overline{\mathfrak{p}}_{2}$, the image of $\mathfrak{p}_{2}$ in $\bar{A}$. Lift back $\bar{\mathfrak{q}}_{2}$ to $B$ and we have a prime ideal $\mathfrak{q}_{2}$ with the required properties.
\end{proof}

\section{Integrally Closed Integral Domains. The Going-down Theorem}

Proposition \eqref{prop:5.6}(ii) can be sharpened:

\begin{proposition}\label{prop:5.12}
Let $A \subseteq B$ be rings, $C$ the integral closure of $A$ in $B$. Let $S$ be a multiplicatively closed subset of $A$. Then $S^{-1} C$ is the integral closure of $S^{-1} A$ in $S^{-1} B$.
\end{proposition}

\begin{proof}
By \eqref{prop:5.6}, $S^{-1} C$ is integral over $S^{-1} A$. Conversely, if $b / s \in S^{-1} B$ is integral over $S^{-1} A$, then we have an equation of the form

\[
(b / s)^{n}+\left(a_{1} / s_{1}\right)(b / s)^{n-1}+\cdots+a_{n} / s_{n}=0
\]

where $a_{1} \in A, s_{i} \in S(1 \leqslant i \leqslant n)$. Let $t=s_{1} \cdots s_{n}$ and multiply this equation by $(s t)^{n}$ throughout. Then it becomes an equation of integral dependence for $b t$ over $A$. Hence $b t \in C$ and therefore $b / s=b t / s t \in S^{-1} C$.
\end{proof}

An integral domain is said to be \textit{integrally closed} (without qualification) if it is integrally closed in its field of fractions. For example, $\mathbf{Z}$ is integrally closed (see (5.0)). The same argument shows that any unique factorization domain is integrally closed. In particular, a polynomial ring $k\left[x_{1}, \ldots, x_{n}\right]$ over a field is integrally closed.

Integral closure is a local property:

\begin{proposition}\label{prop:5.13}
Let $A$ be an integral domain. Then the following are equivalent:
\begin{enumerate}[i)]
\item $A$ is integrally closed;
\item $A_{\mathfrak{p}}$ is integrally closed, for each prime ideal $\mathfrak{p}$;
\item $A_{\mathfrak{m}}$ is integrally closed, for each maximal ideal $\mathfrak{m}$.
\end{enumerate}
\end{proposition}

\begin{proof}
Let $K$ be the field of fractions of $A$, let $C$ be the integral closure of $A$ in $K$, and let $f: A \rightarrow C$ be the identity mapping of $A$ into $C$. Then $A$ is integrally closed $\Leftrightarrow f$ is surjective, and by \eqref{prop:5.12} $A_{\mathfrak{p}}$ (resp. $A_{\mathfrak{m}}$) is integrally closed $\Leftrightarrow f_{\mathfrak{p}}$ (resp. $f_{\mathfrak{m}}$) is surjective. Now use \eqref{prop:3.9}.
\end{proof}

Let $A \subseteq B$ be rings and let $\mathfrak{a}$ be an ideal of $A$. An element of $B$ is said to be \textit{integral over} $\mathfrak{a}$ if it satisfies an equation of integral dependence over $A$ in which all the coefficients lie in $\mathfrak{a}$. The \textit{integral closure} of $\mathfrak{a}$ in $B$ is the set of all elements of $B$ which are integral over $\mathfrak{a}$.

\begin{lemma}\label{lem:5.14}
Let $C$ be the integral closure of $A$ in $B$ and let $\mathfrak{a}^{e}$ denote the extension of $\mathfrak{a}$ in $C$. Then the integral closure of $\mathfrak{a}$ in $B$ is the radical of $\mathfrak{a}^{e}$ (and is therefore closed under addition and multiplication).
\end{lemma}

\begin{proof}
If $x \in B$ is integral over $\mathfrak{a}$, we have an equation of the form

\[
x^{n}+a_{1} x^{n-1}+\cdots+a_{n}=0
\]

with $a_{1}, \ldots, a_{n}$ in $\mathfrak{a}$. Hence $x \in C$ and $x^{n} \in \mathfrak{a}^{e}$, that is $x \in r\left(\mathfrak{a}^{e}\right)$. Conversely, if $x \in r\left(\mathfrak{a}^{e}\right)$ then $x^{n}=\sum a_{i} x_{i}$ for some $n>0$, where the $a_{i}$ are elements of $\mathfrak{a}$ and the $x_{i}$ are elements of $C$. Since each $x_{i}$ is integral over $A$ it follows from \eqref{cor:5.2} that $M=A\left[x_{1}, \ldots, x_{n}\right]$ is a finitely generated $A$-module, and we have $x^{n} M \subseteq \mathfrak{a} M$. Hence by \eqref{prop:2.4} (taking $\phi$ there to be multiplication by $x^{n}$) we see that $x^{n}$ is integral over $\mathfrak{a}$, hence $x$ is integral over $\mathfrak{a}$.
\end{proof}

\begin{proposition}\label{prop:5.15}
Let $A \subseteq B$ be integral domains, $A$ integrally closed, and let $x \in B$ be integral over an ideal $\mathfrak{a}$ of $A$. Then $x$ is algebraic over the field of fractions $K$ of $A$, and if its minimal polynomial over $K$ is $t^{n}+a_{1} t^{n-1}+\cdots+a_{n}$, then $a_{1}, \ldots, a_{n}$ lie in $r(\mathfrak{a})$.
\end{proposition}

\begin{proof}
Clearly $x$ is algebraic over $K$. Let $L$ be an extension field of $K$ which contains all the conjugates $x_{1}, \ldots, x_{n}$ of $x$. Each $x_{i}$ satisfies the same equation of integral dependence as $x$ does, hence each $x_{i}$ is integral over $\mathfrak{a}$. The coefficients of the minimal polynomial of $x$ over $K$ are polynomials in the $x_{i}$, hence by \eqref{lem:5.14} are integral over $\mathfrak{a}$. Since $A$ is integrally closed, they must lie in $r(\mathfrak{a})$, by \eqref{lem:5.14} again.
\end{proof}

\begin{theorem}[Going-down theorem]\label{thm:5.16}
Let $A \subseteq B$ be integral domains, $A$ integrally closed, $B$ integral over $A$. Let $\mathfrak{p}_{1} \supseteq \cdots \supseteq \mathfrak{p}_{n}$ be a chain of prime ideals of $A$, and let $\mathfrak{q}_{1} \supseteq \cdots \supseteq \mathfrak{q}_{m}(m<n)$ be a chain of prime ideals of $B$ such that $\mathfrak{q}_{i} \cap A=\mathfrak{p}_{i}(1 \leqslant i \leqslant m)$. Then the chain $\mathfrak{q}_{1} \supseteq \cdots \supseteq \mathfrak{q}_{m}$ can be extended to a chain $\mathfrak{q}_{1} \supseteq \cdots \supseteq \mathfrak{q}_{n}$ such that $\mathfrak{q}_{i} \cap A=\mathfrak{p}_{i}(1 \leqslant i \leqslant n)$.
\end{theorem}

\begin{proof}
As in \eqref{thm:5.11} we reduce immediately to the case $m=1, n=2$. Then we have to show that $\mathfrak{p}_{2}$ is the contraction of a prime ideal in the ring $B_{\mathfrak{q}_{1}}$, or equivalently \eqref{prop:3.16} that $B_{\mathfrak{q}_{1}} \mathfrak{p}_{2} \cap A=\mathfrak{p}_{2}$.

Every $x \in B_{\mathfrak{q}_{1}} \mathfrak{p}_{2}$ is of the form $y / s$, where $y \in B \mathfrak{p}_{2}$ and $s \in B-\mathfrak{q}_{1}$. By \eqref{lem:5.14}, $y$ is integral over $\mathfrak{p}_{2}$, and hence by \eqref{prop:5.15} its minimal equation over $K$, the field of fractions of $A$, is of the form

\[
y^{r}+u_{1} y^{r-1}+\cdots+u_{r}=0
\]

with $u_{1}, \ldots, u_{r}$ in $\mathfrak{p}_{2}$.

Now suppose that $x \in B_{\mathfrak{q}_{1}} \mathfrak{p}_{2} \cap A$. Then $s=y x^{-1}$ with $x^{-1} \in K$, so that the minimal equation for $s$ over $K$ is obtained by dividing (1) by $x^{r}$, and is therefore, say,

\[
s^{r}+v_{1} s^{r-1}+\cdots+v_{r}=0
\]

where $v_{i}=u_{i} / x^{i}$. Consequently

\[
x^{i} v_{i}=u_{i} \in \mathfrak{p}_{2} \quad(1 \leqslant i \leqslant r) .
\]

But $s$ is integral over $A$, hence by \eqref{prop:5.15} (with $\mathfrak{a}=(1)$ ) each $v_{i}$ is in $A$. Suppose $x \notin \mathfrak{p}_{2}$. Then (3) shows that each $v_{i} \in \mathfrak{p}_{2}$, hence (2) shows that $s^{r} \in B \mathfrak{p}_{2} \subseteq B \mathfrak{p}_{1} \subseteq \mathfrak{q}_{1}$, and therefore $s \in \mathfrak{q}_{1}$, which is a contradiction. Hence $x \in \mathfrak{p}_{2}$ and therefore $B_{\mathfrak{q}_{1}} \mathfrak{p}_{2} \cap A=\mathfrak{p}_{2}$ as required.
\end{proof}

The proof of the next proposition assumes some standard facts from field theory.

\begin{proposition}\label{prop:5.17}
Let $A$ be an integrally closed domain, $K$ its field of fractions, $L$ a finite separable algebraic extension of $K$, $B$ the integral closure of $A$ in $L$. Then there exists a basis $v_{1}, \ldots, v_{n}$ of $L$ over $K$ such that $B \subseteq \sum_{j=1}^{n} A v_{j}$.
\end{proposition}

\begin{proof}
If $v$ is any element of $L$, then $v$ is algebraic over $K$ and therefore satisfies an equation of the form

\[
a_{0} v^{r}+a_{1} v^{r-1}+\cdots+a_{r}=0\left(a_{i} \in A\right) .
\]

Multiplying this equation by $a_{0}^{r-1}$, we see that $a_{0} v=u$ is integral over $A$, and hence is in $B$. Thus, given any basis of $L$ over $K$ we may multiply the basis elements by suitable elements of $A$ to get a basis $u_{1}, \ldots, u_{n}$ such that each $u_{i} \in B$.

Let $T$ denote trace (from $L$ to $K$). Since $L / K$ is separable, the bilinear form $(x, y) \mapsto T(x y)$ on $L$ (considered as a vector space over $K$ ) is non-degenerate, and hence we have a dual basis $v_{1}, \ldots, v_{n}$ of $L$ over $K$, defined by $T\left(u_{i} v_{j}\right)=\delta_{i j}$. Let $x \in B$, say $x=\sum_{j} x_{j} v_{j}\left(x_{j} \in K\right)$. We have $x u_{i} \in B$ (since $u_{i} \in B$ ) and therefore $T\left(x u_{i}\right) \in A$ by \eqref{prop:5.15} (for the trace of an element is a multiple of one of the coefficients in the minimal polynomial). But $T\left(x u_{i}\right)=\sum_{j} T\left(x_{j} u_{i} v_{j}\right)=\sum_{j} x_{j} T\left(u_{i} v_{j}\right)=\sum_{j} x_{j} \delta_{i j}=x_{i}$, hence $x_{i} \in A$. Consequently $B \subseteq \sum_{j} A v_{j}$.
\end{proof}

\section{Valuation Rings}

Let $B$ be an integral domain, $K$ its field of fractions. $B$ is a \textit{valuation ring} of $K$ if, for each $x \neq 0$, either $x \in B$ or $x^{-1} \in B$ (or both).

\begin{proposition}\label{prop:5.18}
\begin{enumerate}[i)]
\item $B$ is a local ring.
\item If $B^{\prime}$ is a ring such that $B \subseteq B^{\prime} \subseteq K$, then $B^{\prime}$ is a valuation ring of $K$.
\item $B$ is integrally closed (in $K$ ).
\end{enumerate}
\end{proposition}

\begin{proof}
\begin{enumerate}[i)]
\item Let $\mathfrak{m}$ be the set of non-units of $B$, so that $x \in \mathfrak{m} \Leftrightarrow$ either $x=0$ or $x^{-1} \notin B$. If $a \in B$ and $x \in \mathfrak{m}$ we have $a x \in \mathfrak{m}$, for otherwise $(a x)^{-1} \in B$ and therefore $x^{-1}=a \cdot(a x)^{-1} \in B$. Next let $x, y$ be non-zero elements of $\mathfrak{m}$. Then either $x y^{-1} \in B$ or $x^{-1} y \in B$. If $x y^{-1} \in B$ then $x+y=\left(1+x y^{-1}\right) y \in B \mathfrak{m} \subseteq \mathfrak{m}$, and similarly if $x^{-1} y \in B$. Hence $\mathfrak{m}$ is an ideal and therefore $B$ is a local ring by \eqref{prop:1.6}.

\item Clear from the definitions.

\item Let $x \in K$ be integral over $B$. Then we have, say,

\[
x^{n}+b_{1} x^{n-1}+\cdots+b_{n}=0
\]

with the $b_{i} \in B$. If $x \in B$ there is nothing to prove. If not, then $x^{-1} \in B$, hence $x=-\left(b_{1}+b_{2} x^{-1}+\cdots+b_{n} x^{1-n}\right) \in B$.
\end{enumerate}
\end{proof}

Let $K$ be a field, $\Omega$ an algebraically closed field. Let $\Sigma$ be the set of all pairs $(A, f)$, where $A$ is a subring of $K$ and $f$ is a homomorphism of $A$ into $\Omega$. We partially order the set $\Sigma$ as follows:

\[
(A, f) \leqslant\left(A^{\prime}, f^{\prime}\right) \Leftrightarrow A \subseteq A^{\prime} \text { and } f^{\prime} \mid A=f .
\]

The conditions of Zorn's lemma are clearly satisfied and therefore the set $\Sigma$ has at least one maximal element.

Let $(B, g)$ be a maximal element of $\Sigma$. We want to prove that $B$ is a valuation ring of $K$. The first step in the proof is

\begin{lemma}\label{lem:5.19}
$B$ is a local ring and $\mathfrak{m}=\operatorname{Ker}(g)$ is its maximal ideal.
\end{lemma}

\begin{proof}
Since $g(B)$ is a subring of a field and therefore an integral domain, the ideal $\mathfrak{m}=\operatorname{Ker}(g)$ is prime. We can extend $g$ to a homomorphism $\bar{g}: B_{\mathfrak{m}} \rightarrow \Omega$ by putting $\bar{g}(b / s)=g(b) / g(s)$ for all $b \in B$ and all $s \in B-\mathfrak{m}$, since $g(s)$ will not be zero. Since the pair $(B, g)$ is maximal it follows that $B=B_{\mathfrak{m}}$, hence $B$ is a local ring and $\mathfrak{m}$ is its maximal ideal.
\end{proof}

\begin{lemma}\label{lem:5.20}
Let $x$ be a non-zero element of $K$. Let $B[x]$ be the subring of $K$ generated by $x$ over $B$, and let $\mathfrak{m}[x]$ be the extension of $\mathfrak{m}$ in $B[x]$. Then either $\mathfrak{m}[x] \neq B[x]$ or $\mathfrak{m}\left[x^{-1}\right] \neq B\left[x^{-1}\right]$.
\end{lemma}

\begin{proof}
Suppose that $\mathfrak{m}[x]=B[x]$ and $\mathfrak{m}\left[x^{-1}\right]=B\left[x^{-1}\right]$. Then we shall have equations

\[
\begin{array}{cc}
u_{0}+u_{1} x+\cdots+u_{m} x^{m}=1 & \left(u_{i} \in \mathfrak{m}\right) \\
v_{0}+v_{1} x^{-1}+\cdots+v_{n} x^{-n}=1 & \left(v_{j} \in \mathfrak{m}\right)
\end{array}
\]

in which we may assume that the degrees $m, n$ are as small as possible. Suppose that $m \geqslant n$, and multiply (2) through by $x^{n}$:

\[
\left(1-v_{0}\right) x^{n}=v_{1} x^{n-1}+\cdots+v_{n} .
\]

Since $v_{0} \in \mathfrak{m}$, it follows from \eqref{lem:5.19} that $1-v_{0}$ is a unit in $B$, and (3) may therefore be written in the form

\[
x^{n}=w_{1} x^{n-1}+\cdots+w_{n} \quad\left(w_{j} \in \mathfrak{m}\right) .
\]

Hence we can replace $x^{m}$ in (1) by $w_{1} x^{m-1}+\cdots+w_{n} x^{m-n}$, and this contradicts the minimality of the exponent $m$.
\end{proof}

\begin{theorem}\label{thm:5.21}
Let $(B, g)$ be a maximal element of $\Sigma$. Then $B$ is a valuation ring of the field $K$.
\end{theorem}

\begin{proof}
We have to show that if $x \neq 0$ is an element of $K$, then either $x \in B$ or $x^{-1} \in B$. By \eqref{lem:5.20} we may as well assume that $\mathfrak{m}[x]$ is not the unit ideal of the ring $B^{\prime}=B[x]$. Then $\mathfrak{m}[x]$ is contained in a maximal ideal $\mathfrak{m}^{\prime}$ of $B^{\prime}$, and we have $\mathfrak{m}^{\prime} \cap B=\mathfrak{m}$ (because $\mathfrak{m}^{\prime} \cap B$ is a proper ideal of $B$ and contains $\mathfrak{m}$). Hence the embedding of $B$ in $B^{\prime}$ induces an embedding of the field $k=B / \mathfrak{m}$ in the field $k^{\prime}=$ $B^{\prime} / \mathfrak{m}^{\prime}$; also $k^{\prime}=k[\bar{x}]$ where $\bar{x}$ is the image of $x$ in $k^{\prime}$, hence $\bar{x}$ is algebraic over $k$, and therefore $k^{\prime}$ is a finite algebraic extension of $k$.

Now the homomorphism $g$ induces an embedding $\bar{g}$ of $k$ in $\Omega$, since by \eqref{lem:5.19} $\mathfrak{m}$ is the kernel of $g$. Since $\Omega$ is algebraically closed, $\bar{g}$ can be extended to an embedding $\bar{g}^{\prime}$ of $k^{\prime}$ into $\Omega$. Composing $\bar{g}^{\prime}$ with the natural homomorphism $B^{\prime} \rightarrow k^{\prime}$, we have, say, $g^{\prime}: B^{\prime} \rightarrow \Omega$ which extends $g$. Since the pair $(B, g)$ is maximal, it follows that $B^{\prime}=B$ and therefore $x \in B$.
\end{proof}

\begin{corollary}\label{cor:5.22}
Let $A$ be a subring of a field $K$. Then the integral closure $\bar{A}$ of $A$ in $K$ is the intersection of all the valuation rings of $K$ which contain $A$.
\end{corollary}

\begin{proof}
Let $B$ be a valuation ring of $K$ such that $A \subseteq B$. Since $B$ is integrally closed, by \eqref{prop:5.18} iii), it follows that $\bar{A} \subseteq B$.

Conversely, let $x \notin \bar{A}$. Then $x$ is not in the ring $A^{\prime}=A\left[x^{-1}\right]$. Hence $x^{-1}$ is a non-unit in $A^{\prime}$ and is therefore contained in a maximal ideal $\mathfrak{m}^{\prime}$ of $A^{\prime}$. Let $\Omega$ be an algebraic closure of the field $k^{\prime}=A^{\prime} / \mathfrak{m}^{\prime}$. Then the restriction to $A$ of the natural homomorphism $A^{\prime} \rightarrow k^{\prime}$ defines a homomorphism of $A$ into $\Omega$. By \eqref{thm:5.21} this can be extended to some valuation ring $B \supseteq A$. Since $x^{-1}$ maps to zero, it follows that $x \notin B$.
\end{proof}

\begin{proposition}\label{prop:5.23}
Let $A \subseteq B$ be integral domains, $B$ finitely generated over $A$. Let $v$ be a non-zero element of $B$. Then there exists $u \neq 0$ in $A$ with the following property: any homomorphism $f$ of $A$ into an algebraically closed field $\Omega$ such that $f(u) \neq 0$ can be extended to a homomorphism $g$ of $B$ into $\Omega$ such that $g(v) \neq 0$.
\end{proposition}

\begin{proof}
By induction on the number of generators of $B$ over $A$ we reduce immediately to the case where $B$ is generated over $A$ by a single element $x$.

\begin{enumerate}[i)]
\item Suppose $x$ is transcendental over $A$, i.e., that no non-zero polynomial with coefficients in $A$ has $x$ as a root. Let $v=a_{0} x^{n}+a_{1} x^{n-1}+\cdots+a_{n}$, and take $u=a_{0}$. Then if $f: A \rightarrow \Omega$ is such that $f(u) \neq 0$, there exists $\xi \in \Omega$ such that $f\left(a_{0}\right) \xi^{n}+f\left(a_{1}\right) \xi^{n-1}+\cdots+f\left(a_{n}\right) \neq 0$, because $\Omega$ is infinite. Define $g: B \rightarrow \Omega$ extending $f$ by putting $g(x)=\xi$. Then $g(v) \neq 0$, as required.

\item Now suppose $x$ is algebraic over $A$ (i.e. over the field of fractions of $A$). Then so is $v^{-1}$, because $v$ is a polynomial in $x$. Hence we have equations of the form

\[
\begin{array}{ll}
a_{0} x^{m}+a_{1} x^{m-1}+\cdots+a_{m}=0 & \left(a_{i} \in A\right) \\
a_{0}^{\prime} v^{-n}+a_{1}^{\prime} v^{1-n}+\cdots+a_{n}^{\prime}=0 & \left(a_{j}^{\prime} \in A\right) .
\end{array}
\]

Let $u=a_{0} a_{0}^{\prime}$, and let $f: A \rightarrow \Omega$ be such that $f(u) \neq 0$. Then $f$ can be extended, first to a homomorphism $f_{1}: A\left[u^{-1}\right] \rightarrow \Omega$ (with $f_{1}\left(u^{-1}\right)=f(u)^{-1}$ ), and then by \eqref{thm:5.21} to a homomorphism $h: C \rightarrow \Omega$, where $C$ is a valuation ring containing $A\left[u^{-1}\right]$. From (1), $x$ is integral over $A\left[u^{-1}\right]$, hence by \eqref{cor:5.22} $x \in C$, so that $C$ contains $B$, and in particular $v \in C$. On the other hand, from (2), $v^{-1}$ is integral over $A\left[u^{-1}\right]$, and therefore by \eqref{cor:5.22} again is in $C$. Therefore $v$ is a unit in $C$, and hence $h(v) \neq 0$. Now take $g$ to be the restriction of $h$ to $B$.
\end{enumerate}
\end{proof}

\begin{corollary}\label{cor:5.24}
Let $k$ be a field and $B$ a finitely generated $k$-algebra. If $B$ is a field then it is a finite algebraic extension of $k$.
\end{corollary}

\begin{proof}
Take $A=k, v=1$ and $\Omega=$ algebraic closure of $k$.
\end{proof}

\eqref{cor:5.24} is one form of Hilbert's Nullstellensatz. For another proof, see \eqref{prop:7.9}.

\section{Exercises}
\begin{enumerate}
\item Let $f: A \rightarrow B$ be an integral homomorphism of rings. Show that $f^{*}: \operatorname{Spec}(B) \rightarrow \operatorname{Spec}(A)$ is a closed mapping, i.e. that it maps closed sets to closed sets. (This is a geometrical equivalent of \eqref{thm:5.10}.)

\item Let $A$ be a subring of a ring $B$ such that $B$ is integral over $A$, and let $f: A \rightarrow \Omega$ be a homomorphism of $A$ into an algebraically closed field $\Omega$. Show that $f$ can be extended to a homomorphism of $B$ into $\Omega$. [Use \eqref{thm:5.10}.]

\item Let $f: B \rightarrow B^{\prime}$ be a homomorphism of $A$-algebras, and let $C$ be an $A$-algebra. If $f$ is integral, prove that $f \otimes 1: B \otimes_{A} C \rightarrow B^{\prime} \otimes_{A} C$ is integral. (This includes \eqref{prop:5.6} ii) as a special case.)

\item Let $A$ be a subring of a ring $B$ such that $B$ is integral over $A$. Let $\mathfrak{n}$ be a maximal ideal of $B$ and let $\mathfrak{m}=\mathfrak{n} \cap A$ be the corresponding maximal ideal of $A$. Is $B_{\mathfrak{n}}$ necessarily integral over $A_{\mathfrak{m}}$?

[Consider the subring $k\left[x^{2}-1\right]$ of $k[x]$, where $k$ is a field, and let $\mathfrak{n}=(x-1)$. Can the element $1 /(x+1)$ be integral?]

\item Let $A \subseteq B$ be rings, $B$ integral over $A$.
\begin{enumerate}[i)]
\item If $x \in A$ is a unit in $B$ then it is a unit in $A$.
\item The Jacobson radical of $A$ is the contraction of the Jacobson radical of $B$.
\end{enumerate}

\item Let $B_{1}, \ldots, B_{n}$ be integral $A$-algebras. Show that $\prod_{i=1}^{n} B_{i}$ is an integral $A$-algebra.

\item Let $A$ be a subring of a ring $B$, such that the set $B-A$ is closed under multiplication. Show that $A$ is integrally closed in $B$.

\item \begin{enumerate}[i)]
\item Let $A$ be a subring of an integral domain $B$, and let $C$ be the integral closure of $A$ in $B$. Let $f, g$ be monic polynomials in $B[x]$ such that $f g \in C[x]$. Then $f, g$ are in $C[x]$. [Take a field containing $B$ in which the polynomials $f, g$ split into linear factors: say $f=\Pi\left(x-\xi_{i}\right), g=\Pi\left(x-\eta_{j}\right)$. Each $\xi_{i}$ and each $\eta_{j}$ is a root of $f g$, hence is integral over $C$. Hence the coefficients of $f$ and $g$ are integral over $C$.]
\item Prove the same result without assuming that $B$ (or $A$ ) is an integral domain.
\end{enumerate}

\item Let $A$ be a subring of a ring $B$ and let $C$ be the integral closure of $A$ in $B$. Prove that $C[x]$ is the integral closure of $A[x]$ in $B[x]$. [If $f \in B[x]$ is integral over $A[x]$, then

\[
f^{m}+g_{1} f^{m-1}+\cdots+g_{m}=0 \quad\left(g_{i} \in A[x]\right) .
\]

Let $r$ be an integer larger than $m$ and the degrees of $g_{1}, \ldots, g_{m}$, and let $f_{1}=f-x^{r}$, so that

\[
\left(f_{1}+x^{r}\right)^{m}+g_{1}\left(f+x^{r}\right)^{m-1}+\cdots+g_{m}=0
\]

or say

\[
f_{1}^{m}+h_{1} f_{1}^{m-1}+\cdots+h_{m}=0 \text {, }
\]

where $h_{m}=\left(x^{r}\right)^{m}+g_{1}\left(x^{r}\right)^{m-1}+\cdots+g_{m} \in A[x]$. Now apply Exercise 8 to the polynomials $-f_{1}$ and $f_{1}^{m-1}+h_{1} f_{1}^{m-2}+\cdots+h_{m-1}$.]

\item A ring homomorphism $f: A \rightarrow B$ is said to have the \textit{going-up property} (resp. the \textit{going-down property}) if the conclusion of the going-up theorem \eqref{thm:5.11} (resp. the going-down theorem \eqref{thm:5.16}) holds for $B$ and its subring $f(A)$.

Let $f^{*}: \operatorname{Spec}(B) \rightarrow \operatorname{Spec}(A)$ be the mapping associated with $f$.
\begin{enumerate}[i)]
\item Consider the following three statements:
\begin{enumerate}
\item[(a)] $f^{*}$ is a closed mapping.
\item[(b)] $f$ has the going-up property.
\item[(c)] Let $\mathfrak{q}$ be any prime ideal of $B$ and let $\mathfrak{p}=\mathfrak{q}^{c}$. Then $f^{*}: \operatorname{Spec}(B / \mathfrak{q}) \rightarrow \operatorname{Spec}(A / \mathfrak{p})$ is surjective.
\end{enumerate}
Prove that $(a) \Rightarrow(b) \Leftrightarrow$ (c). (See also Chapter 6, Exercise 11.)

\item Consider the following three statements:
\begin{enumerate}
\item[(a$^{\prime}$)] $f^{*}$ is an open mapping.
\item[(b$^{\prime}$)] $f$ has the going-down property.
\item[(c$^{\prime}$)] For any prime ideal $\mathfrak{q}$ of $B$, if $\mathfrak{p}=\mathfrak{q}^{c}$, then $f^{*}: \operatorname{Spec}\left(B_{\mathfrak{q}}\right) \rightarrow \operatorname{Spec}\left(A_{\mathfrak{p}}\right)$ is surjective.
\end{enumerate}
Prove that $\left(a^{\prime}\right) \Rightarrow\left(b^{\prime}\right) \Rightarrow\left(c^{\prime}\right)$. (See also Chapter 7, Exercise 23.)

[To prove that (a) $\Rightarrow\left(\mathrm{c}^{\prime}\right)$, observe that $B_{\mathfrak{q}}$ is the direct limit of the rings $B_{t}$ where $t \in B-\mathfrak{q}$; hence, by Chapter 3, Exercise 26, we have $f^{*}\left(\operatorname{Spec}\left(B_{\mathfrak{q}}\right)\right)=$ $\bigcap_{t} f^{*}\left(\operatorname{Spec}\left(B_{t}\right)\right)=\bigcap_{t} f^{*}\left(Y_{t}\right)$. Since $Y_{t}$ is an open neighborhood of $\mathfrak{q}$ in $Y$, and since $f^{*}$ is open, it follows that $f^{*}\left(Y_{t}\right)$ is an open neighborhood of $\mathfrak{p}$ in $X$ and therefore contains $\operatorname{Spec}\left(A_{\mathfrak{p}}\right)$.]
\end{enumerate}

\item Let $f: A \rightarrow B$ be a flat homomorphism of rings. Then $f$ has the going-down property. [Chapter 3, Exercise 18.]

\item Let $G$ be a finite group of automorphisms of a ring $A$, and let $A^{G}$ denote the subring of $G$-invariants, that is of all $x \in A$ such that $\sigma(x)=x$ for all $\sigma \in G$. Prove that $A$ is integral over $A^{G}$. [If $x \in A$, observe that $x$ is a root of the polynomial $\prod_{\sigma \in G}(t-\sigma(x))$.]

Let $S$ be a multiplicatively closed subset of $A$ such that $\sigma(S) \subseteq S$ for all $\sigma \in G$, and let $S^{G}=S \cap A^{G}$. Show that the action of $G$ on $A$ extends to an action on $S^{-1} A$, and that $\left(S^{G}\right)^{-1} A^{G} \cong\left(S^{-1} A\right)^{G}$.

\item In the situation of Exercise 12, let $\mathfrak{p}$ be a prime ideal of $A^{G}$, and let $P$ be the set of prime ideals of $A$ whose contraction is $\mathfrak{p}$. Show that $G$ acts transitively on $P$. In particular, $P$ is finite. [Let $\mathfrak{p}_{1}, \mathfrak{p}_{2} \in P$ and let $x \in \mathfrak{p}_{1}$. Then $\prod_{\sigma} \sigma(x) \in \mathfrak{p}_{1} \cap A^{G}=\mathfrak{p} \subseteq \mathfrak{p}_{2}$, hence $\sigma(x) \in \mathfrak{p}_{2}$ for some $\sigma \in G$. Deduce that $\mathfrak{p}_{1}$ is contained in $\bigcup_{\sigma \in G} \sigma\left(\mathfrak{p}_{2}\right)$, and then apply \eqref{prop:1.11} and \eqref{cor:5.9}.]

\item Let $A$ be an integrally closed domain, $K$ its field of fractions and $L$ a finite normal separable extension of $K$. Let $G$ be the Galois group of $L$ over $K$ and let $B$ be the integral closure of $A$ in $L$. Show that $\sigma(B)=B$ for all $\sigma \in G$, and that $A=B^{G}$.

\item Let $A, K$ be as in Exercise 14, let $L$ be any finite extension field of $K$, and let $\bar{B}$ be the integral closure of $A$ in $L$. Show that, if $\mathfrak{p}$ is any prime ideal of $A$, then the set of prime ideals $\mathfrak{q}$ of $B$ which contract to $\mathfrak{p}$ is finite (in other words, that $\operatorname{Spec}(B) \rightarrow \operatorname{Spec}(A)$ has finite fibers).

[Reduce to the two cases (a) $L$ separable over $K$ and (b) $L$ purely inseparable over $K$. In case (a), embed $L$ in a finite normal separable extension of $K$, and use Exercises 13 and 14. In case (b), if $\mathfrak{q}$ is a prime ideal of $B$ such that $\mathfrak{q} \cap A=\mathfrak{p}$, show that $\mathfrak{q}$ is the set of all $x \in B$ such that $x^{p^{m}} \in \mathfrak{p}$ for some $m \geqslant 0$, where $p$ is the characteristic of $K$, and hence that $\operatorname{Spec}(B) \rightarrow \operatorname{Spec}(A)$ is bijective in this case.]

\item \textbf{Noether's normalization lemma.}
Let $k$ be a field and let $A \neq 0$ be a finitely generated $k$-algebra. Then there exist elements $y_{1}, \ldots, y_{r} \in A$ which are algebraically independent over $k$ and such that $A$ is integral over $k\left[y_{1}, \ldots, y_{r}\right]$.

We shall assume that $k$ is infinite. (The result is still true if $k$ is finite, but a different proof is needed.) Let $x_{1}, \ldots, x_{n}$ generate $A$ as a $k$-algebra. We can renumber the $x_{i}$ so that $x_{1}, \ldots, x_{r}$ are algebraically independent over $k$ and each of $x_{r+1}, \ldots, x_{n}$ is algebraic over $k\left[x_{1}, \ldots, x_{r}\right]$. Now proceed by induction on $n$. If $n=r$ there is nothing to do, so suppose $n>r$ and the result true for $n-1$ generators. The generator $x_{n}$ is algebraic over $k\left[x_{1}, \ldots, x_{n-1}\right]$, hence there exists a polynomial $f \neq 0$ in $n$ variables such that $f\left(x_{1}, \ldots, x_{n-1}, x_{n}\right)=0$. Let $F$ be the homogeneous part of highest degree in $f$. Since $k$ is infinite, there exist $\lambda_{1}, \ldots, \lambda_{n-1} \in k$ such that $F\left(\lambda_{1}, \ldots, \lambda_{n-1}, 1\right) \neq 0$. Put $x_{i}^{\prime}=x_{i}-\lambda_{i} x_{n}$ $(1 \leqslant i \leqslant n-1)$. Show that $x_{n}$ is integral over the ring $A^{\prime}=k\left[x_{1}^{\prime}, \ldots, x_{n-1}^{\prime}\right]$, and hence that $A$ is integral over $A^{\prime}$. Then apply the inductive hypothesis to $A^{\prime}$ to complete the proof.

From the proof it follows that $y_{1}, \ldots, y_{r}$ may be chosen to be linear combinations of $x_{1}, \ldots, x_{n}$. This has the following geometrical interpretation: if $k$ is algebraically closed and $X$ is an affine algebraic variety in $k^{n}$ with coordinate ring $A \neq 0$, then there exists a linear subspace $L$ of dimension $r$ in $k^{n}$ and a linear mapping of $k^{n}$ onto $L$ which maps $X$ onto $L$. [Use Exercise 2.]

\item \textbf{Nullstellensatz (weak form).}
Let $X$ be an affine algebraic variety in $k^{n}$, where $k$ is an algebraically closed field, and let $I(X)$ be the ideal of $X$ in the polynomial ring $k\left[t_{1}, \ldots, t_{n}\right]$ (Chapter 1, Exercise 27). If $I(X) \neq(1)$ then $X$ is not empty. [Let $A=k\left[t_{1}, \ldots, t_{n}\right] / I(X)$ be the coordinate ring of $X$. Then $A \neq 0$, hence by Exercise 16 there exists a linear subspace $L$ of dimension $\geqslant 0$ in $k^{n}$ and a mapping of $X$ onto $L$. Hence $X \neq \varnothing$. Deduce that every maximal ideal in the ring $k\left[t_{1}, \ldots, t_{n}\right]$ is of the form $\left(t_{1}-a_{1}, \ldots, t_{n}-a_{n}\right)$ where $a_{i} \in k$.

\item Let $k$ be a field and let $B$ be a finitely generated $k$-algebra. Suppose that $B$ is a field. Then $B$ is a finite algebraic extension of $k$. (This is another version of Hilbert's Nullstellensatz. The following proof is due to Zariski. For other proofs, see \eqref{cor:5.24}, \eqref{prop:7.9}.)

Let $x_{1}, \ldots, x_{n}$ generate $B$ as a $k$-algebra. The proof is by induction on $n$. If $n=1$ the result is clearly true, so assume $n>1$. Let $A=k\left[x_{1}\right]$ and let $K=k\left(x_{1}\right)$ be the field of fractions of $A$. By the inductive hypothesis, $B$ is a finite algebraic extension of $K$, hence each of $x_{2}, \ldots, x_{n}$ satisfies a monic polynomial equation with coefficients in $K$, i.e. coefficients of the form $a / b$ where $a$ and $b$ are in $A$. If $f$ is the product of the denominators of all these coefficients, then each of $x_{2}, \ldots, x_{n}$ is integral over $A_{f}$. Hence $B$ and therefore $K$ is integral over $A_{f}$.

Suppose $x_{1}$ is transcendental over $k$. Then $A$ is integrally closed, because it is a unique factorization domain. Hence $A_{f}$ is integrally closed \eqref{prop:5.12}, and therefore $A_{f}=K$, which is clearly absurd. Hence $x_{1}$ is algebraic over $k$, hence $K$ (and therefore $B$) is a finite extension of $k$.

\item Deduce the result of Exercise 17 from Exercise 18.

\item Let $A$ be a subring of an integral domain $B$ such that $B$ is finitely generated over $A$. Show that there exists $s \neq 0$ in $A$ and elements $y_{1}, \ldots, y_{n}$ in $B$, algebraically independent over $A$ and such that $B_{s}$ is integral over $B_{s}^{\prime}$, where $B^{\prime}=A\left[y_{1}, \ldots, y_{n}\right]$. [Let $S=A-\{0\}$ and let $K=S^{-1} A$, the field of fractions of $A$. Then $S^{-1} B$ is a finitely generated $K$-algebra and therefore by the normalization lemma (Exercise 16) there exist $x_{1}, \ldots, x_{n}$ in $S^{-1} B$, algebraically independent over $K$ and such that $S^{-1} B$ is integral over $K\left[x_{1}, \ldots, x_{n}\right]$. Let $z_{1}, \ldots, z_{m}$ generate $B$ as an $A$-algebra. Then each $z_{j}$ (regarded as an element of $S^{-1} B$) is integral over $K\left[x_{1}, \ldots, x_{n}\right]$. By writing an equation of integral dependence for each $z_{j}$, show that there exists $s \in S$ such that $x_{i}=y_{i} / s(1 \leqslant i \leqslant n)$ with $y_{i} \in B$, and such that each $s z_{j}$ is integral over $B^{\prime}$. Deduce that this $s$ satisfies the conditions stated.]

\item Let $A, B$ be as in Exercise 20. Show that there exists $s \neq 0$ in $A$ such that, if $\Omega$ is an algebraically closed field and $f: A \rightarrow \Omega$ is a homomorphism for which $f(s) \neq 0$, then $f$ can be extended to a homomorphism $B \rightarrow \Omega$. [With the notation of Exercise 20, $f$ can be extended first of all to $B^{\prime}$, for example by mapping each $y_{i}$ to 0; then to $B_{s}^{\prime}$ (because $f(s) \neq 0$), and finally to $B_{s}$ (by Exercise 2, because $B_{s}$ is integral over $B_{s}^{\prime}$).]

\item Let $A, B$ be as in Exercise 20. If the Jacobson radical of $A$ is zero, then so is the Jacobson radical of $B$.

[Let $v \neq 0$ be an element of $B$. We have to show that there is a maximal ideal of $B$ which does not contain $v$. By applying Exercise 21 to the ring $B_{v}$ and its subring $A$, we obtain an element $s \neq 0$ in $A$. Let $\mathfrak{m}$ be a maximal ideal of $A$ such that $s \notin \mathfrak{m}$, and let $k=A / \mathfrak{m}$. Then the canonical mapping $A \rightarrow k$ extends to a homomorphism $g$ of $B_{v}$ into an algebraic closure $\Omega$ of $k$. Show that $g(v) \neq 0$ and that $\operatorname{Ker}(g) \cap B$ is a maximal ideal of $B$.]

\item Let $A$ be a ring. Show that the following are equivalent:
\begin{enumerate}[i)]
\item Every prime ideal in $A$ is an intersection of maximal ideals.
\item In every homomorphic image of $A$ the nilradical is equal to the Jacobson radical.
\item Every prime ideal in $A$ which is not maximal is equal to the intersection of the prime ideals which contain it strictly.
\end{enumerate}
[The only hard part is iii) $\Rightarrow$ ii). Suppose ii) false, then there is a prime ideal which is not an intersection of maximal ideals. Passing to the quotient ring, we may assume that $A$ is an integral domain whose Jacobson radical $\mathfrak{R}$ is not zero. Let $f$ be a non-zero element of $\mathfrak{R}$. Then $A_{f} \neq 0$, hence $A_{f}$ has a maximal ideal, whose contraction in $A$ is a prime ideal $\mathfrak{p}$ such that $f \notin \mathfrak{p}$, and which is maximal with respect to this property. Then $\mathfrak{p}$ is not maximal and is not equal to the intersection of the prime ideals strictly containing $\mathfrak{p}$.]

A ring $A$ with the three equivalent properties above is called a \textit{Jacobson ring}.

\item Let $A$ be a Jacobson ring (Exercise 23) and $B$ an $A$-algebra. Show that if $B$ is either (i) integral over $A$ or (ii) finitely generated as an $A$-algebra, then $B$ is Jacobson. [Use Exercise 22 for (ii).]

In particular, every finitely generated ring, and every finitely generated algebra over a field, is a Jacobson ring.

\item Let $A$ be a ring. Show that the following are equivalent:
\begin{enumerate}[i)]
\item $A$ is a Jacobson ring;
\item Every finitely generated $A$-algebra $B$ which is a field is finite over $A$.
\end{enumerate}
[\begin{enumerate}[i)]
\item $\Rightarrow$ ii). Reduce to the case where $A$ is a subring of $B$, and use Exercise 21. If $s \in A$ is as in Exercise 21, then there exists a maximal ideal $\mathfrak{m}$ of $A$ not containing $s$, and the homomorphism $A \rightarrow A / \mathfrak{m}=k$ extends to a homomorphism $g$ of $B$ into the algebraic closure of $k$. Since $B$ is a field, $g$ is injective, and $g(B)$ is algebraic over $k$, hence finite algebraic over $k$.

\item $\Rightarrow$ i). Use criterion iii) of Exercise 23. Let $\mathfrak{p}$ be a prime ideal of $A$ which is not maximal, and let $\bar{B}=A / \mathfrak{p}$. Let $f$ be a non-zero element of $\bar{B}$. Then $\bar{B}_{f}$ is a finitely generated $A$-algebra. If it is a field it is finite over $\bar{B}$, hence integral over $\bar{B}$ and therefore $\bar{B}$ is a field by \eqref{prop:5.7}. Hence $\bar{B}_{f}$ is not a field and therefore has a non-zero prime ideal, whose contraction in $\bar{B}$ is a non-zero ideal $\mathfrak{p}^{\prime}$ such that $f \notin \mathfrak{p}^{\prime}$.
\end{enumerate}]

\item Let $X$ be a topological space. A subset of $X$ is \textit{locally closed} if it is the intersection of an open set and a closed set, or equivalently if it is open in its closure.

The following conditions on a subset $X_{0}$ of $X$ are equivalent:
\begin{enumerate}
\item[(1)] Every non-empty locally closed subset of $X$ meets $X_{0}$;
\item[(2)] For every closed set $E$ in $X$ we have $\overline{E \cap X_{0}}=E$;
\item[(3)] The mapping $U \mapsto U \cap X_{0}$ of the collection of open sets of $X$ onto the collection of open sets of $X_{0}$ is bijective.
\end{enumerate}
A subset $X_{0}$ satisfying these conditions is said to be \textit{very dense} in $X$.

If $A$ is a ring, show that the following are equivalent:
\begin{enumerate}[i)]
\item $A$ is a Jacobson ring;
\item The set of maximal ideals of $A$ is very dense in $\operatorname{Spec}(A)$;
\item Every locally closed subset of $\operatorname{Spec}(A)$ consisting of a single point is closed.
\end{enumerate}
[(ii) and iii) are geometrical formulations of conditions ii) and iii) of Exercise 23.]
\end{enumerate}

\section{Valuation rings and valuations}
\begin{enumerate}
\setcounter{enumi}{26}
\item Let $A, B$ be two local rings. $B$ is said to \textit{dominate} $A$ if $A$ is a subring of $B$ and the maximal ideal $\mathfrak{m}$ of $A$ is contained in the maximal ideal $\mathfrak{n}$ of $B$ (or, equivalently, if $\mathfrak{m}=\mathfrak{n} \cap A$). Let $K$ be a field and let $\Sigma$ be the set of all local subrings of $K$. If $\Sigma$ is ordered by the relation of domination, show that $\Sigma$ has maximal elements and that $A \in \Sigma$ is maximal if and only if $A$ is a valuation ring of $K$. [Use \eqref{thm:5.21}.]

\item Let $A$ be an integral domain, $K$ its field of fractions. Show that the following are equivalent:
\begin{enumerate}
\item[(1)] $A$ is a valuation ring of $K$;
\item[(2)] If $\mathfrak{a}, \mathfrak{b}$ are any two ideals of $A$, then either $\mathfrak{a} \subseteq \mathfrak{b}$ or $\mathfrak{b} \subseteq \mathfrak{a}$.
\end{enumerate}
Deduce that if $A$ is a valuation ring and $\mathfrak{p}$ is a prime ideal of $A$, then $A_{\mathfrak{p}}$ and $A / \mathfrak{p}$ are valuation rings of their fields of fractions.

\item Let $A$ be a valuation ring of a field $K$. Show that every subring of $K$ which contains $A$ is a local ring of $A$.

\item Let $A$ be a valuation ring of a field $K$. The group $U$ of units of $A$ is a subgroup of the multiplicative group $K^{*}$ of $K$.

Let $\Gamma=K^{*} / U$. If $\xi, \eta \in \Gamma$ are represented by $x, y \in K$, define $\xi \geqslant \eta$ to mean $x y^{-1} \in A$. Show that this defines a total ordering on $\Gamma$ which is compatible with the group structure (i.e., $\xi \geqslant \eta \Rightarrow \xi \omega \geqslant \eta \omega$ for all $\omega \in \Gamma$). In other words, $\Gamma$ is a totally ordered abelian group. It is called the \textit{value group} of $A$.

Let $v: K^{*} \rightarrow \Gamma$ be the canonical homomorphism. Show that $v(x+y) \geqslant \min (v(x), v(y))$ for all $x, y \in K^{*}$.

\item Conversely, let $\Gamma$ be a totally ordered abelian group (written additively), and let $K$ be a field. A \textit{valuation} of $K$ with values in $\Gamma$ is a mapping $v: K^{*} \rightarrow \Gamma$ such that (1) $v(x y)=v(x)+v(y)$,

(2) $v(x+y) \geqslant \min (v(x), v(y))$,

for all $x, y \in K^{*}$. Show that the set of elements $x \in K^{*}$ such that $v(x) \geqslant 0$ is a valuation ring of $K$. This ring is called the \textit{valuation ring} of $v$, and the subgroup $v\left(K^{*}\right)$ of $\Gamma$ is the \textit{value group} of $v$.

Thus the concepts of valuation ring and valuation are essentially equivalent.

\item Let $\Gamma$ be a totally ordered abelian group. A subgroup $\Delta$ of $\Gamma$ is \textit{isolated} in $\Gamma$ if, whenever $0 \leqslant \beta \leqslant \alpha$ and $\alpha \in \Delta$, we have $\beta \in \Delta$. Let $A$ be a valuation ring of a field $K$, with value group $\Gamma$ (Exercise 31). If $\mathfrak{p}$ is a prime ideal of $A$, show that $v(A-\mathfrak{p})$ is the set of elements $\geqslant 0$ in an isolated subgroup $\Delta$ of $\Gamma$, and that the mapping so defined of $\operatorname{Spec}(A)$ into the set of isolated subgroups of $\Gamma$ is bijective.

If $\mathfrak{p}$ is a prime ideal of $A$, what are the value groups of the valuation rings $A / \mathfrak{p}, A_{\mathfrak{p}}$?

\item Let $\Gamma$ be a totally ordered abelian group. We shall show how to construct a field $K$ and a valuation $v$ of $K$ with $\Gamma$ as value group. Let $k$ be any field and let $A=k[\Gamma]$ be the group algebra of $\Gamma$ over $k$. By definition, $A$ is freely generated as a $k$-vector space by elements $x_{\alpha}(\alpha \in \Gamma)$ such that $x_{\alpha} x_{\beta}=x_{\alpha+\beta}$. Show that $A$ is an integral domain.

If $u=\lambda_{1} x_{\alpha_{1}}+\cdots+\lambda_{n} x_{\alpha_{n}}$ is any non-zero element of $A$, where the $\lambda_{i}$ are all $\neq 0$ and $\alpha_{1}<\cdots<\alpha_{n}$, define $v_{0}(u)$ to be $\alpha_{1}$. Show that the mapping $v_{0}: A-\{0\} \rightarrow \Gamma$ satisfies conditions (1) and (2) of Exercise 31.

Let $K$ be the field of fractions of $A$. Show that $v_{0}$ can be uniquely extended to a valuation $v$ of $K$, and that the value group of $v$ is precisely $\Gamma$.

\item Let $A$ be a valuation ring and $K$ its field of fractions. Let $f: A \rightarrow B$ be a ring homomorphism such that $f^{*}: \operatorname{Spec}(B) \rightarrow \operatorname{Spec}(A)$ is a closed mapping. Then if $g: B \rightarrow K$ is any $A$-algebra homomorphism (i.e., if $g \circ f$ is the embedding of $A$ in $K$) we have $g(B)=A$.

[Let $C=g(B)$; obviously $C \supseteq A$. Let $\mathfrak{n}$ be a maximal ideal of $C$. Since $f^{*}$ is closed, $\mathfrak{m}=\mathfrak{n} \cap A$ is the maximal ideal of $A$, whence $A_{\mathfrak{m}}=A$. Also the local ring $C_{\mathfrak{n}}$ dominates $A_{\mathfrak{m}}$. Hence by Exercise 27 we have $C_{\mathfrak{n}}=A$ and therefore $C \subseteq A$.]

\item From Exercises 1 and 3 it follows that, if $f: A \rightarrow B$ is integral and $C$ is any $A$-algebra, then the mapping $(f \otimes 1)^{*}: \operatorname{Spec}\left(B \otimes_{A} C\right) \rightarrow \operatorname{Spec}(C)$ is a closed map.

Conversely, suppose that $f: A \rightarrow B$ has this property and that $B$ is an integral domain. Then $f$ is integral. [Replacing $A$ by its image in $B$, reduce to the case where $A \subseteq B$ and $f$ is the injection. Let $K$ be the field of fractions of $B$ and let $A^{\prime}$ be a valuation ring of $K$ containing $A$. By \eqref{cor:5.22} it is enough to show that $A^{\prime}$ contains $B$. By hypothesis $\operatorname{Spec}\left(B \otimes_{A} A^{\prime}\right) \rightarrow \operatorname{Spec}\left(A^{\prime}\right)$ is a closed map. Apply the result of Exercise 34 to the homomorphism $B \otimes_{A} A^{\prime} \rightarrow K$ defined by $b \otimes a^{\prime} \mapsto b a^{\prime}$. It follows that $b a^{\prime} \in A^{\prime}$ for all $b \in B$ and all $a^{\prime} \in A^{\prime}$; taking $a^{\prime}=1$, we have what we want.]

Show that the result just proved remains valid if $B$ is a ring with only finitely many minimal prime ideals (e.g., if $B$ is Noetherian). [Let $\mathfrak{p}_{i}$ be the minimal prime ideals. Then each composite homomorphism $A \rightarrow B \rightarrow B / \mathfrak{p}_{i}$ is integral, hence $A \rightarrow \prod\left(B / \mathfrak{p}_{i}\right)$ is integral, hence $A \rightarrow B / \mathfrak{N}$ is integral (where $\mathfrak{N}$ is the nilradical of $B$), hence finally $A \rightarrow B$ is integral.]
\end{enumerate}
